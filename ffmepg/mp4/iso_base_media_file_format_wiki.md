# ISO 基本媒体文件格式

- [ISO 基本媒体文件格式](#iso-基本媒体文件格式)
  - [概述](#概述)
  - [历史](#历史)
  - [扩展](#扩展)
  - [技术细节](#技术细节)
    - [文件类型 box](#文件类型-box)
    - [流](#流)

翻译 [ISO/IEC base media file format](https://en.wikipedia.org/wiki/ISO/IEC_base_media_file_format)。

## 概述

**ISO/IEC 基本媒体文件格式**(ISO/IEC 14496-12: MPEG-4 第 12 部分)为基于时间的多媒体文件(比如视频和音频)定义了通用结构。相同的文本也发布到 ISO/IEC 15444-12(JPEG 2000, 第 12 部分)。

此文件格式被设计为一种灵活、可扩展的格式，以方便媒体的交换、管理、编辑和展示。媒体展示可以是本地的，或经由网络或其他流传递机制。它的设计独立于任何特定的网络协议，但总体支持这些网络协议。它被用作其他媒体文件格式(比如容器格式 MP4 和 3GP)的基础。

## 历史

ISO/IEC 基本媒体文件格式直接基于苹果的 QuickTime 容器格式。它是由 MPEG(ISO/IEC JTC1/SC29/WG11) 开发的。第一个 MP4 文件格式规范基于 2001 年发布的 QuickTime 格式规范创建。“第 1 版” MP4 文件格式在 2001 年作为 ISO/IEC 14496-1:2001 发布，修正了 “MPEG-4 第 14 部分: 系统”。“MPEG-4 第 14 部分: MP4 文件格式”(ISO/IEC 14496-14:2003)，通常称为 MPEG-4 文件格式“第 2 版”，在 2003 年发布，它修正并替代了第 1 版。将 MP4 文件格式通用化为 ISO/IEC 基本媒体文件格式(ISO/IEC 14496-12:2004 或 ISO/IEC 15444-12:2004)，它为基于时间的媒体文件定义了通用结构。并将其作为该家族其他文件格式的基础(比如 MP4、3GP、Motion JPEG 2000)。

MPEG-4 第 12 部分/JPEG 2000 第 12 部分版本

| 版本 | 发布日期 | 最新修订 | 标准 | 描述 |
| --- | --- | --- | --- | --- |
| 第 1 版 | 2004 | - | ISO/IEC 14496-12:2004, ISO/IEC 15444-12:2004 | - |
| 第 2 版 | 2005 | 2008 | ISO/IEC 14496-12:2005, ISO/IEC 15444-12:2005 | - |
| 第 3 版 | 2008 | 2009 | ISO/IEC 14496-12:2008, ISO/IEC 15444-12:2008 | - |
| 第 4 版 | 2012 | - | ISO/IEC 14496-12:2012, ISO/IEC 15444-12:2012 | - |
| 第 5 版 | 2015 | - | ISO/IEC 14496-12:2015, ISO/IEC 15444-12:2015 | - |

2017 年 1月，撤回了 ISO/IEC 15444-12，改为采用  ISO/IEC 14496-12:2015。

## 扩展

ISO/IEC 基本媒体文件格式被设计为可扩展的文件格式。。。。。。

## 技术细节

ISO/IEC 基本媒体文件格式为定时的媒体数据序列(比如音视频演示)存储时间、结构和媒体信息。文件结构是面向对象的。可以非常简单地将文件分解为基本对象，基本对象的类型隐含对象的结构。

符合 ISO/IEC 基本媒体文件格式的文件被组织成一系列对象，称为 “box”。所有数据都保存在 box 中，且文件内部没有其他数据。这包括特定文件格式所需的任何初始签名。box 是面向对象的构建块，由一个唯一的类型标识符和长度定义。在一些规范中也称为 “atom”(比如 MP4 文件格式的第一个定义)。

演示(运动序列)可能包含在多个文件中。所有时间和帧(位置和大小)信息必须在 ISO 基本媒体文件中，且附属文件实际上可使用任何格式。附属文件必须只能由 ISO/IEC 基本媒体文件格式中定义的元数据描述。

### 文件类型 box

为了识别基于 ISO/IEC 基本媒体文件格式的文件所遵循的规范，在文件格式中使用 brand 作为标识符。在，名为文件类型 box(“ftye”)的 box 中设置 brand，且此 box 必须放在文件开头。它有点类似所谓的 fource 代码，嵌入 AVI 容器格式的媒体出于类似目的会使用 fource 代码。brand 可能会指示使用的编码类型、每种编码数据的存储方式、文件适用的限制和扩展名、兼容性，或文件的预期用途。brand 是可打印的四字符的代码。文件类型 box 包含两种 brand。一种是 “major_brand”，它表示了文件最佳使用的规范。其后跟随的是 “minor_version”，是 4 字节的信息整数，用于主 brand 的次要版本。第二种 brand 是 “compatible_brands”，它标识文件遵循的多个规范。所有文件应该包含一个文件类型 box，但是为了和规范的早期版本兼容，文件可能符合 ISO/IEC 基本媒体文件格式，但是并未包含文件类型 box。在这种情况下，应将其视为包含了一个 ftyp，其中有主要和兼容性 brand “mp41”(MP4 v1 – ISO 14496-1, 第 13 章)。许多在用的 brand (ftyp) 并未注册，且可以在某些网页上找到。

基于 ISO/IEC 基本媒体文件格式构造的多媒体文件可能兼容多个具体规范，因此并非总是谈论该文件的单个 “type” 或 “brand”。在这方面。多用途 Internet 邮件扩展名类型和文件扩展名的作用有所减少。尽管如此，当编写派生规范时，将使用新的文件扩展名、新的 MIME 类型和新的 Macintosh 文件类型。

### 流

ISO/IEC 基本媒体文件格式 支持通过网络的媒体数据流和本地回放。支持流传输的文件包含有关流传输的数据单元的信息(如何通过流传输协议为文件中的基本流数据提供服务)。该信息放在文件额外的轨道，称为 “hint” 轨道。同一文件中可能为不同协议保存单独的 “hint” 轨道。媒体将通过所有此类协议播放，而无需添加媒体数据的其他副本或版本。通过增加适当的 hint 轨道，可轻松地将现有媒体用于其他特定协议的流传输。媒体信息本身不需要任何重新格式化。服务器在 hint 轨道指示下发送的流不需要包含具体文件的跟踪信息。当本地回放演示时(不是流传输)，hint 轨道可以忽略。可使用创作工具创建 hint 轨道，或者使用提示工具将其添加到现有文件(演示)。为渐进式下载创作的媒体中，包含帧索引的 moov box 应放在电影数据 mdat box 之前。
